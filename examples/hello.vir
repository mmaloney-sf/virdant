pub mod Top {
    incoming clk : Clock;
    incoming reset : Word[1];
    outgoing out : Word[3];

    out := buffer.out;

    reg counter : Word[3] on clk;
    counter <= if reset { 0 } else { counter->add(1) };

    mod buffer of Buffer;
    buffer.clk := clk;
    buffer.in := counter;
}

mod Buffer {
    incoming clk : Clock;
    incoming in : Word[3];
    outgoing out : Word[3];

    reg buffer : Word[3] on clk;
    buffer <= in;
    out := buffer;
}
